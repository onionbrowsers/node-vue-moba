(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22c504"],{f367:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=this,s=t.$createElement,a=t._self._c||s;return a("div",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:this.id,expression:"this.id"}],attrs:{type:"text"},on:{click:function(e){return t.$router.push("/heros/list")}}},[t._v("返回")]),a("h1",[t._v(t._s(t.id?"编辑":"新建")+"英雄")]),a("el-form",{ref:"goodsForm",attrs:{model:t.model,"label-width":"120px"},nativeOn:{submit:function(e){return e.preventDefault(),t.save(e)}}},[a("el-tabs",{attrs:{type:"border-card",value:"basic"}},[a("el-tab-pane",{attrs:{label:"基础信息",name:"basic"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:t.model.name,callback:function(e){t.$set(t.model,"name",e)},expression:"model.name"}})],1),a("el-form-item",{attrs:{label:"称号"}},[a("el-input",{model:{value:t.model.title,callback:function(e){t.$set(t.model,"title",e)},expression:"model.title"}})],1),a("el-form-item",{attrs:{label:"头像"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadUrl+"/upload",headers:t.getAuthHeaders(),"show-file-list":!1,"on-success":t.afterUpload}},[t.model.avatar?a("img",{staticClass:"avatar",attrs:{src:t.model.avatar}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"背景图"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadUrl+"/upload",headers:t.getAuthHeaders(),"show-file-list":!1,"on-success":function(s){return t.$set(e.model,"banner",s.url)}}},[t.model.banner?a("img",{staticClass:"avatar",attrs:{src:t.model.banner}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{multiple:""},model:{value:t.model.categories,callback:function(e){t.$set(t.model,"categories",e)},expression:"model.categories"}},t._l(t.categories,(function(e){return a("el-option",{key:e._id,attrs:{label:e.name,value:e._id}})})),1)],1),a("el-form-item",{attrs:{label:"难度"}},[a("el-rate",{staticStyle:{"margin-top":"0.7rem"},attrs:{max:9,"show-score":""},model:{value:t.model.scores.difficult,callback:function(e){t.$set(t.model.scores,"difficult",e)},expression:"model.scores.difficult"}})],1),a("el-form-item",{attrs:{label:"技能"}},[a("el-rate",{staticStyle:{"margin-top":"0.7rem"},attrs:{max:9,"show-score":""},model:{value:t.model.scores.skill,callback:function(e){t.$set(t.model.scores,"skill",e)},expression:"model.scores.skill"}})],1),a("el-form-item",{attrs:{label:"攻击"}},[a("el-rate",{staticStyle:{"margin-top":"0.7rem"},attrs:{max:9,"show-score":""},model:{value:t.model.scores.attack,callback:function(e){t.$set(t.model.scores,"attack",e)},expression:"model.scores.attack"}})],1),a("el-form-item",{attrs:{label:"生存"}},[a("el-rate",{staticStyle:{"margin-top":"0.7rem"},attrs:{max:9,"show-score":""},model:{value:t.model.scores.survive,callback:function(e){t.$set(t.model.scores,"survive",e)},expression:"model.scores.survive"}})],1),a("el-form-item",{attrs:{label:"顺风出装"}},[a("el-select",{attrs:{multiple:""},model:{value:t.model.items1,callback:function(e){t.$set(t.model,"items1",e)},expression:"model.items1"}},t._l(t.items,(function(e){return a("el-option",{key:e._id,attrs:{label:e.name,value:e._id}})})),1)],1),a("el-form-item",{attrs:{label:"使用技巧"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.model.usageTips,callback:function(e){t.$set(t.model,"usageTips",e)},expression:"model.usageTips"}})],1),a("el-form-item",{attrs:{label:"对抗技巧"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.model.battleTips,callback:function(e){t.$set(t.model,"battleTips",e)},expression:"model.battleTips"}})],1),a("el-form-item",{attrs:{label:"团战思路"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.model.teamTips,callback:function(e){t.$set(t.model,"teamTips",e)},expression:"model.teamTips"}})],1)],1),a("el-tab-pane",{attrs:{label:"技能",name:"skill"}},[a("el-button",{style:{visibility:t.model.skills.length>3?"hidden":"visible"},attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){return t.model.skills.push({})}}},[t._v("添加技能")]),a("el-row",{staticStyle:{"flex-wrap":"wrap"},attrs:{type:"flex"}},t._l(t.model.skills,(function(e,s){return a("el-col",{key:s,attrs:{md:12}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:e.name,callback:function(s){t.$set(e,"name",s)},expression:"item.name"}})],1),a("el-form-item",{attrs:{label:"图标"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadUrl+"/upload","show-file-list":!1,"on-success":function(s){return t.$set(e,"icon",s.url)}}},[e.icon?a("img",{staticClass:"avatar",attrs:{src:e.icon}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:3}},model:{value:e.description,callback:function(s){t.$set(e,"description",s)},expression:"item.description"}})],1),a("el-form-item",{attrs:{label:"小提示"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:3}},model:{value:e.tips,callback:function(s){t.$set(e,"tips",s)},expression:"item.tips"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){return t.model.skills.splice(s,1)}}},[t._v("删除")])],1)],1)})),1)],1),a("el-tab-pane",{attrs:{label:"最佳搭档",name:"partners"}},[a("el-button",{style:{visibility:t.model.partners.length>1?"hidden":"visible"},attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){return t.model.partners.push({})}}},[t._v("添加搭档")]),a("el-row",{staticStyle:{"flex-wrap":"wrap"},attrs:{type:"flex"}},t._l(t.model.partners,(function(e,s){return a("el-col",{key:s,attrs:{md:12}},[a("el-form-item",{attrs:{label:"英雄"}},[a("el-select",{model:{value:e.hero,callback:function(s){t.$set(e,"hero",s)},expression:"item.hero"}},t._l(t.heros,(function(e){return a("el-option",{key:e._id,attrs:{value:e._id,label:e.name}})})),1)],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:3}},model:{value:e.description,callback:function(s){t.$set(e,"description",s)},expression:"item.description"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){return t.model.partners.splice(s,1)}}},[t._v("删除")])],1)],1)})),1)],1)],1),a("el-form-item",{staticClass:"el-test",staticStyle:{"margin-top":"1rem"}},[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[t._v("保存")])],1)],1)],1)},r=[],l=(s("ac1f"),s("5319"),s("96cf"),s("1da1")),i={props:{id:{type:String,default:""}},data:function(){return{model:{scores:{},skills:[],partners:[]},categories:[],items:[],heros:[]}},created:function(){this.uploadUrl=this.$http.defaults.baseURL.replace("/rest",""),this.id&&this.fetch(),this.fetchCategories(),this.fetchItems(),this.fetchHeros()},watch:{id:function(e){e||(this.model={scores:{},skills:[],partners:[]})}},methods:{afterUpload:function(e){this.$set(this.model,"avatar",e.url)},save:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.model.skills.length){e.next=8;break}t=0;case 2:if(!(t<this.model.skills.length)){e.next=8;break}if("{}"!==JSON.stringify(this.model.skills[t])){e.next=5;break}return e.abrupt("return",this.$message.error("请将技能填写完整"));case 5:t++,e.next=2;break;case 8:if(!this.model.partners.length){e.next=16;break}s=0;case 10:if(!(s<this.model.partners.length)){e.next=16;break}if("{}"!==JSON.stringify(this.model.partners[s])){e.next=13;break}return e.abrupt("return",this.$message.error("请将搭档填写完整"));case 13:s++,e.next=10;break;case 16:if(!this.id){e.next=22;break}return e.next=19,this.$http.put("heros/"+this.id,this.model);case 19:a=e.sent,e.next=25;break;case 22:return e.next=24,this.$http.post("heros",this.model);case 24:a=e.sent;case 25:console.log(a),this.$router.push("/heros/list"),this.$message.success("保存成功");case 28:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),fetch:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("heros/"+this.id);case 2:for(s in t=e.sent,t.data)this.$set(this.model,s,t.data[s]);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),fetchCategories:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("categories/",{params:{list:"heros"}});case 2:t=e.sent,this.categories=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),fetchItems:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("items/");case 2:t=e.sent,this.items=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),fetchHeros:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("heros/");case 2:t=e.sent,this.heros=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},n=i,o=s("2877"),c=Object(o["a"])(n,a,r,!1,null,null,null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-2d22c504.c7267cea.js.map